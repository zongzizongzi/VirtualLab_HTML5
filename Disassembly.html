<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="js/math/math.js" type="text/javascript"></script>
    <link rel="stylesheet" href="css/main.css">
    <script type='text/javascript' src='x3dom/x3dom.js'> </script>
    <link rel='stylesheet' type='text/css' href='x3dom/x3dom.css'>
    <script>
        function show(i) {
            if(i>3||i<0) {alert("indexErr");return;}
            else {
                for(let j=0;j<3;j++){
                    if(j==i)document.getElementById("index_"+i).style.display="block";
                    else document.getElementById("index_"+j).style.display="none";
                }
            }
            if(i!=2)document.getElementById("demo").pause();
            else document.getElementById("demo").play();
            if(i!=3)document.getElementById("exm_video").pause();
            else document.getElementById("exm_video").play();
        }
    </script>
</head>
<body>
<div class="main-div" style="width: 1500px;">
    <div class="title"><b>机器人操作实验(型号：ABB_IRB120)</b></div>
    <div class="back" ><a href="index.html">←返回主目录</a>/<a href="Robotics.html">机器人目录</a></div>
    <!--<button onclick="openTeachPendant()">打开虚拟示教器</button>-->
    <div id="index_div_robotics">
        <button class="InstBtn" onclick="show(0)">实验说明书</button><button class="InstBtn" onclick="show(2)">虚拟实验演示</button><button class="InstBtn" onclick="show(1)">开始实验</button>
    </div>
    <div id="index_0" style="width: 1500px;"> <embed id="instructTxt" src="pdf/Robotics/baseTheoryExperiment/robotDisassembly.htm" ></embed></div>
    <div id="index_2"><video id="demo" src="video/demo/disassembly.mp4" controls></video></div>
    <div id="index_3"><video id="exm_video" src="" controls></video></div>
    <div id="index_1" style="height: 800px">
        <div class="rowFlex-div" style="background: #aaddffb8">
            <input type="radio" name="robotIndex" value="1" checked="checked">关节型机器人
            <input type="radio" name="robotIndex" value="2">并联型机器人
            <input type="radio" name="robotIndex" value="3">SCARA机器人
            <input type="radio" name="robotIndex" value="4">直角坐标机器人
        </div>
        <div style="width: 100%;height: 100%;display: inline;float: left">
            <div id="robotX3d" style="width: 100%;height: 100%;">
            </div>
        </div>
    </div>

</div>
<script src="js/VILibrary.js"></script>
<!--js简写方法-->
<script src="js/jquery-3.1.1.min.js"></script>
<!--弹出框-->
<script src="js/layui/lay/dest/layui.all.js"></script>
<script src="js/communication.js"></script>
<script>
    'use strict';
    let disassemblyVI = new VILibrary.VI.DisassemblyVI($('#robotX3d'), true);
//    let downPos=[0,0,0];
    window.onload=function() {
        $('input[type=radio][name=robotIndex]').change(function() {
            let method=this.value;
            disassemblyVI.changeRobot(method);
        });
    };
    function processTranslationGizmoEvent(event)
    {
        var sensorToWorldMatrix, translationValue;

        if (event.fieldName === 'translation_changed')
        {
            //convert the sensor's output from sensor coordinates to world coordinates (i.e., include its 'axisRotation')
            sensorToWorldMatrix = x3dom.fields.SFMatrix4f.parseRotation(event.target.getAttribute("axisRotation"));

            translationValue = sensorToWorldMatrix.multMatrixVec(event.value);

            //transform the affected sensor geometry
            event.target.parentNode.getElementsByTagName('transform')[0].setFieldValue('translation', translationValue);
        }
    }

</script>
</body>
</html>